<root>
	<styles>
		<include src="file://{resources}/styles/custom_game/crafting/item_mini.css" />
		<include src="file://{resources}/styles/custom_game/crafting/rarities.css" />
		<include src="file://{resources}/styles/custom_game/ingame_ui_windows.css" />
	</styles>
	<script>
		$( "#ItemImage" ).AddClass("rarity-normal rarity-magic rarity-rare rarity-epic rarity-legendary");

		function SetRarity( rarity )
		{
			$( "#ItemImage" ).SetHasClass("rarity-normal rarity-magic rarity-rare rarity-epic rarity-legendary", false);

			var rarityClass = "rarity-normal";
			switch( rarity )
			{
				case 1:
					rarityClass = "rarity-magic";
					break;

				case 2:
					rarityClass = "rarity-rare";
					break;

				case 3:
					rarityClass = "rarity-epic";
					break;

				case 4:
					rarityClass = "rarity-legendary";
					break;
			}

			$( "#ItemImage" ).SetHasClass(rarityClass, true )
		}

		function Update( id )
		{
			SetRarity( 0 );

			$( "#ItemImage" ).itemname = id;
		}

		function SetCount( count )
		{
			$( "#Count" ).RemoveClass("Hide");
			$( "#Count" ).text = count;
		}

		function ItemShowTooltip()
		{
			if ( $( "#ItemImage" ).itemname == -1 )
				return;

			var itemName = $( "#ItemImage" ).itemname;
			$.DispatchEvent( "DOTAShowAbilityTooltipForEntityIndex", $.GetContextPanel(), itemName, Game.GetLocalPlayerInfo()["player_selected_hero_entity_index"] );
		}

		function ItemHideTooltip()
		{
			$.DispatchEvent( "DOTAHideAbilityTooltip", $.GetContextPanel() );
		}

		$.GetContextPanel().Update = Update;
		$.GetContextPanel().SetCount = SetCount;
	</script>
	<Panel hittest="false">
		<DOTAItemImage hittest="true" id="ItemImage" 
				onmouseover="ItemShowTooltip()"
				onmouseout="ItemHideTooltip()"
				/> 
		<Label class="Hide" id="Count" text="1" />
	</Panel>
</root>
